name: traffic2badge

on:
  schedule:
    - cron: '1 0 * * *'  # ë§¤ì¼ UTC 00:01 (KST 09:01ì¯¤)
  workflow_dispatch:

jobs:
  run:
    runs-on: ubuntu-latest
    permissions:
      contents: write  # docs ë¸Œëœì¹˜ë¡œ í‘¸ì‹œ
    steps:
      - uses: actions/checkout@v4

      # GitHub íŠ¸ë˜í”½(views/clones)ì„ ì½ì–´ ë±ƒì§€(SVG) ìƒì„±
      - id: traffic
        uses: yi-Xu-0100/traffic-to-badge@v1.4.0
        with:
          my_token: ${{ secrets.PAT_LABLER }}

          # (ì„ íƒ) ìƒ‰ìƒ ì»¤ìŠ¤í„°ë§ˆì´ì¦ˆ
          clones_color: brightgreen
          total_clones_color: brightgreen
          views_color: blue
          total_views_color: blue

      # ìƒì„±ëœ ë±ƒì§€ë§Œ docs ë¸Œëœì¹˜ì˜ badges/ ê²½ë¡œë¡œ ë°°í¬
      - name: Publish badges to docs/badges
        uses: peaceiris/actions-gh-pages@v4
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}  # ë¦¬í¬ ê¸°ë³¸ í† í°ìœ¼ë¡œ push
          publish_branch: docs
          publish_dir: ${{ steps.traffic.outputs.traffic_path }}  # ì•¡ì…˜ì´ ë§Œë“  í´ë”
          destination_dir: badges
          keep_files: true                 # ğŸ”‘ ê¸°ì¡´ ì›¹ì•±/ë‹¤ë¥¸ íŒŒì¼ ìœ ì§€
          enable_jekyll: false
          commit_message: "chore(badge): update traffic badges [skip ci]"
